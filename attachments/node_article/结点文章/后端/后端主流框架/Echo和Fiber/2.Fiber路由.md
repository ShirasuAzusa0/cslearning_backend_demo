## ğŸ”Œ è·¯ç”±

## å¤„ç†ç¨‹åº[](#handlers "ç›´æ¥é“¾æ¥åˆ°å¤„ç†ç¨‹åº")

æ³¨å†Œç»‘å®šåˆ°ç‰¹å®š [HTTP æ–¹æ³•](https://mdn.org.cn/en-US/docs/Web/HTTP/Methods) çš„è·¯ç”±ã€‚

ç­¾å

```go
// HTTP methodsfunc (app *App) Get(path string, handlers ...Handler) Routerfunc (app *App) Head(path string, handlers ...Handler) Routerfunc (app *App) Post(path string, handlers ...Handler) Routerfunc (app *App) Put(path string, handlers ...Handler) Routerfunc (app *App) Delete(path string, handlers ...Handler) Routerfunc (app *App) Connect(path string, handlers ...Handler) Routerfunc (app *App) Options(path string, handlers ...Handler) Routerfunc (app *App) Trace(path string, handlers ...Handler) Routerfunc (app *App) Patch(path string, handlers ...Handler) Router// Add allows you to specifiy a method as valuefunc (app *App) Add(method, path string, handlers ...Handler) Router// All will register the route on all HTTP methods// Almost the same as app.Use but not bound to prefixesfunc (app *App) All(path string, handlers ...Handler) Router
```

ç¤ºä¾‹

```go
// Simple GET handlerapp.Get("/api/list", func(c *fiber.Ctx) error {  return c.SendString("I'm a GET request!")})// Simple POST handlerapp.Post("/api/register", func(c *fiber.Ctx) error {  return c.SendString("I'm a POST request!")})
```

**Use** å¯ç”¨äºä¸­é—´ä»¶åŒ…å’Œå‰ç¼€æ•è·å™¨ã€‚è¿™äº›è·¯ç”±åªä¼šåŒ¹é…æ¯æ¡è·¯å¾„çš„å¼€å¤´ï¼Œå³ `/john` å°†åŒ¹é… `/john/doe`ã€`/johnnnnn` ç­‰

ç­¾å

```go
func (app *App) Use(args ...interface{}) Router
```

ç¤ºä¾‹

```go
// Match any requestapp.Use(func(c *fiber.Ctx) error {    return c.Next()})// Match request starting with /apiapp.Use("/api", func(c *fiber.Ctx) error {    return c.Next()})// Match requests starting with /api or /home (multiple-prefix support)app.Use([]string{"/api", "/home"}, func(c *fiber.Ctx) error {    return c.Next()})// Attach multiple handlers app.Use("/api", func(c *fiber.Ctx) error {  c.Set("X-Custom-Header", random.String(32))    return c.Next()}, func(c *fiber.Ctx) error {    return c.Next()})
```

## è·¯å¾„[](#paths "ç›´æ¥é“¾æ¥åˆ°è·¯å¾„")

è·¯ç”±è·¯å¾„ä¸è¯·æ±‚æ–¹æ³•ç›¸ç»“åˆï¼Œå®šä¹‰äº†å¯ä»¥è¿›è¡Œè¯·æ±‚çš„ç«¯ç‚¹ã€‚è·¯ç”±è·¯å¾„å¯ä»¥æ˜¯ **å­—ç¬¦ä¸²** æˆ– **å­—ç¬¦ä¸²æ¨¡å¼**ã€‚

**åŸºäºå­—ç¬¦ä¸²çš„è·¯ç”±è·¯å¾„ç¤ºä¾‹**

```go
// This route path will match requests to the root route, "/":app.Get("/", func(c *fiber.Ctx) error {      return c.SendString("root")})// This route path will match requests to "/about":app.Get("/about", func(c *fiber.Ctx) error {    return c.SendString("about")})// This route path will match requests to "/random.txt":app.Get("/random.txt", func(c *fiber.Ctx) error {    return c.SendString("random.txt")})
```

ä¸ expressJs æ¡†æ¶ä¸€æ ·ï¼Œè·¯ç”±å£°æ˜çš„é¡ºåºèµ·ç€ä½œç”¨ã€‚æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œå°†æŒ‰å£°æ˜çš„é¡ºåºæ£€æŸ¥è·¯ç”±ã€‚

ä¿¡æ¯

å› æ­¤ï¼Œè¯·åŠ¡å¿…å°å¿ƒåœ¨åŒ…å«å›ºå®šéƒ¨åˆ†çš„è·¯ç”±åç¼–å†™å…·æœ‰å¯å˜å‚æ•°çš„è·¯ç”±ï¼Œä»¥ä¾¿è¿™äº›å¯å˜éƒ¨åˆ†ä¸ä¼šåŒ¹é…ï¼Œä»è€Œå¯¼è‡´æ„å¤–è¡Œä¸ºã€‚

## å‚æ•°[](#parameters "ç›´æ¥é“¾æ¥åˆ°å‚æ•°")

è·¯ç”±å‚æ•°æ˜¯è·¯ç”±ä¸­çš„åŠ¨æ€å…ƒç´ ï¼Œå®ƒä»¬æ˜¯**å‘½å**æˆ–**æœªå‘½åæ®µ**ã€‚è¿™äº›æ®µç”¨äºæ•è·åœ¨ URL ä¸­å…¶ä½ç½®å¤„æŒ‡å®šçš„å€¼ã€‚å¯ä»¥ä½¿ç”¨ [Params](https://fiber.wiki/context#params) å‡½æ•°æ£€ç´¢è·å¾—çš„å€¼ï¼Œè¯¥å‡½æ•°ä½¿ç”¨è·¯å¾„ä¸­æŒ‡å®šçš„è·¯ç”±å‚æ•°åç§°ä½œä¸ºå…¶å„è‡ªçš„é”®ï¼Œæˆ–å¯¹äºæœªå‘½åçš„å‚æ•°ï¼Œä½¿ç”¨å­—ç¬¦(\*, +)åŠå…¶è®¡æ•°å™¨ã€‚

å­—ç¬¦ :, +, å’Œ \* æ˜¯å¼•å…¥å‚æ•°çš„å­—ç¬¦ã€‚

è´ªå©ªå‚æ•°ç”±é€šé…ç¬¦(\*)æˆ–åŠ å·(+)ç¬¦å·è¡¨ç¤ºã€‚

è·¯ç”±è¿˜æä¾›äº†ä½¿ç”¨å¯é€‰å‚æ•°çš„å¯èƒ½æ€§ï¼Œå¯¹äºå‘½åå‚æ•°ï¼Œè¿™äº›å‚æ•°ç”¨æœ€ç»ˆçš„â€œ?â€æ ‡è®°ï¼Œä¸éå¯é€‰çš„åŠ å·ä¸åŒï¼Œæ‚¨å¯ä»¥å°†é€šé…ç¬¦å­—ç¬¦ç”¨äºå¯é€‰ä¸”è´ªå©ªçš„å‚æ•°èŒƒå›´ã€‚

**ä½¿ç”¨è·¯ç”±å‚æ•°å®šä¹‰è·¯ç”±çš„ç¤ºä¾‹**

```go
// Parametersapp.Get("/user/:name/books/:title", func(c *fiber.Ctx) error {    fmt.Fprintf(c, "%s\n", c.Params("name"))    fmt.Fprintf(c, "%s\n", c.Params("title"))    return nil})// Plus - greedy - not optionalapp.Get("/user/+", func(c *fiber.Ctx) error {    return c.SendString(c.Params("+"))})// Optional parameterapp.Get("/user/:name?", func(c *fiber.Ctx) error {    return c.SendString(c.Params("name"))})// Wildcard - greedy - optionalapp.Get("/user/*", func(c *fiber.Ctx) error {    return c.SendString(c.Params("*"))})// This route path will match requests to "/v1/some/resource/name:customVerb", since the parameter character is escapedapp.Get(`/v1/some/resource/name\:customVerb`, func(c *fiber.Ctx) error {    return c.SendString("Hello, Community")})
```

ä¿¡æ¯

ç”±äºè¿å­—ç¬¦ (`-`) å’Œç‚¹ (`.`) è¢«é€å­—è§£é‡Šï¼Œå› æ­¤å¯ä»¥å°†å®ƒä»¬ä¸è·¯ç”±å‚æ•°ä¸€èµ·ç”¨äºæœ‰ç”¨çš„ç›®çš„ã€‚

ä¿¡æ¯

æ‰€æœ‰ç‰¹æ®Šå‚æ•°å­—ç¬¦ä¹Ÿå¯ä»¥ç”¨ `"\\"` è½¬ä¹‰å¹¶å¤±å»å…¶å€¼ï¼Œå› æ­¤æ‚¨å¯ä»¥æ ¹æ®éœ€è¦åœ¨è·¯ç”±ä¸­ä½¿ç”¨å®ƒä»¬ï¼Œå°±åƒåœ¨ [google api è®¾è®¡æŒ‡å—](https://cloud.google.com/apis/design/custom_methods) çš„è‡ªå®šä¹‰æ–¹æ³•ä¸­ä¸€æ ·ã€‚å»ºè®®ä½¿ç”¨åå¼•å· `` ` ``ï¼Œå› ä¸ºåœ¨ go çš„æ­£åˆ™è¡¨è¾¾å¼æ–‡æ¡£ä¸­ï¼Œå®ƒä»¬å§‹ç»ˆä½¿ç”¨åå¼•å·ä»¥ç¡®ä¿æ˜ç¡®ï¼Œå¹¶ä¸”è½¬ä¹‰å­—ç¬¦ä¸ä¼šä»¥æ„å¤–çš„æ–¹å¼å¹²æ‰°æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ã€‚

```go
// https://127.0.0.1:3000/plantae/prunus.persicaapp.Get("/plantae/:genus.:species", func(c *fiber.Ctx) error {    fmt.Fprintf(c, "%s.%s\n", c.Params("genus"), c.Params("species"))    return nil // prunus.persica})
```

```go
// https://127.0.0.1:3000/flights/LAX-SFOapp.Get("/flights/:from-:to", func(c *fiber.Ctx) error {    fmt.Fprintf(c, "%s-%s\n", c.Params("from"), c.Params("to"))    return nil // LAX-SFO})
```

æˆ‘ä»¬çš„æ™ºèƒ½è·¯ç”±å™¨è¯†åˆ«å‡ºå¼•å…¥å‚æ•°å­—ç¬¦åœ¨è¿™ç§æƒ…å†µä¸‹åº”æˆä¸ºè¯·æ±‚è·¯ç”±çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚

```go
// https://127.0.0.1:3000/shop/product/color:blue/size:xsapp.Get("/shop/product/color::color/size::size", func(c *fiber.Ctx) error {    fmt.Fprintf(c, "%s:%s\n", c.Params("color"), c.Params("size"))    return nil // blue:xs})
```

æ­¤å¤–ï¼Œè·¯ç”±ä¸­å¯ä»¥æœ‰å¤šä¸ªè¿ç»­çš„å‚æ•°å’Œå¤šä¸ªæœªå‘½åçš„å‚æ•°å­—ç¬¦ï¼Œä¾‹å¦‚é€šé…ç¬¦æˆ–åŠ å·å­—ç¬¦ï¼Œè¿™æå¤§åœ°æ‰©å±•äº†è·¯ç”±å™¨å¯¹ç”¨æˆ·æ¥è¯´çš„å¯èƒ½æ€§ã€‚

```go
// GET /@v1// Params: "sign" -> "@", "param" -> "v1"app.Get("/:sign:param", handler)// GET /api-v1// Params: "name" -> "v1" app.Get("/api-:name", handler)// GET /customer/v1/cart/proxy// Params: "*1" -> "customer/", "*2" -> "/cart"app.Get("/*v1*/proxy", handler)// GET /v1/brand/4/shop/blue/xs// Params: "*1" -> "brand/4", "*2" -> "blue/xs"app.Get("/v1/*/shop/*", handler)
```

æˆ‘ä»¬å·²å°†è·¯ç”±ä¸ express è·¯ç”±è¿›è¡Œäº†å¼ºé€‚é…ï¼Œä½†ç›®å‰ä¸å…·å¤‡æ­£åˆ™è¡¨è¾¾å¼çš„å¯èƒ½æ€§ï¼Œå› ä¸ºå®ƒä»¬ç›¸å½“æ…¢ã€‚å¯ä»¥åœ¨ [Express è·¯ç”±æµ‹è¯•å™¨](http://forbeslindesay.github.io/express-route-tester/) çš„åœ¨çº¿ç‰ˆæœ¬ 0.1.7ï¼ˆexpress 4ï¼‰ä¸­æµ‹è¯•å¯èƒ½æ€§ã€‚

### çº¦æŸ[](#constraints "Direct link to Constraints")

å½“ä¸ä¼ å…¥ URL åŒ¹é…å¹¶ä¸” URL è·¯å¾„é€šè¿‡å‚æ•°æ ‡è®°ä¸ºè·¯ç”±å€¼æ—¶ï¼Œè·¯ç”±çº¦æŸä¼šæ‰§è¡Œã€‚æ­¤åŠŸèƒ½åœ¨ `v2.37.0` ä¸­å¼•å…¥ï¼Œå¹¶å— [.NET Core](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-6.0#route-constraints) çš„å¯å‘ã€‚

æ³¨æ„

çº¦æŸä¸æ˜¯å‚æ•°çš„éªŒè¯ã€‚å¦‚æœçº¦æŸå¯¹å‚æ•°å€¼æ— æ•ˆï¼ŒFiber å°†è¿”å› **404 å¤„ç†ç¨‹åº**ã€‚

| çº¦æŸ              | ç¤ºä¾‹                                  | ç¤ºä¾‹åŒ¹é…                                                     |
| ----------------- | ------------------------------------- | ------------------------------------------------------------ |
| int               | `:id<int\>`                           | 123456789, -123456789                                        |
| bool              | `:active<bool\>`                      | true,false                                                   |
| guid              | `:id<guid\>`                          | CD2C1638-1638-72D5-1638-DEADBEEF1638                         |
| float             | `:weight<float\>`                     | 1.234, -1,001.01e8                                           |
| minLen(value)     | `:username<minLen(4)\>`               | Testï¼ˆå¿…é¡»è‡³å°‘åŒ…å« 4 ä¸ªå­—ç¬¦ï¼‰                                |
| maxLen(value)     | `:filename<maxLen(8)\>`               | MyFileï¼ˆä¸å¾—è¶…è¿‡ 8 ä¸ªå­—ç¬¦ï¼‰                                  |
| len(length)       | `:filename<len(12)\>`                 | somefile.txtï¼ˆæ°å¥½ 12 ä¸ªå­—ç¬¦ï¼‰                               |
| min(value)        | `:age<min(18)\>`                      | 19ï¼ˆæ•´æ•°å€¼å¿…é¡»è‡³å°‘ä¸º 18ï¼‰                                    |
| max(value)        | `:age<max(120)\>`                     | 91ï¼ˆæ•´æ•°å€¼ä¸å¾—è¶…è¿‡ 120ï¼‰                                     |
| range(min,max)    | `:age<range(18,120)\>`                | 91ï¼ˆæ•´æ•°å€¼å¿…é¡»è‡³å°‘ä¸º 18ï¼Œä½†ä¸å¾—è¶…è¿‡ 120ï¼‰                    |
| alpha             | `:name<alpha\>`                       | Rickï¼ˆå­—ç¬¦ä¸²å¿…é¡»åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ¯å­—ç¬¦ï¼Œa-zï¼Œä¸”ä¸åŒºåˆ†å¤§å°å†™ï¼‰ |
| datetime          | `:dob<datetime(2006\\\\-01\\\\-02)\>` | 2005-11-01                                                   |
| regex(expression) | `:date<regex(\\d{4}-\\d{2}-\\d{2})\>` | 2022-08-27ï¼ˆå¿…é¡»åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼‰                             |

**ç¤ºä¾‹**

+   å•ä¸ªçº¦æŸ
+   å¤šä¸ªçº¦æŸ
+   æ­£åˆ™çº¦æŸ

```go
app.Get("/:test<min(5)>", func(c *fiber.Ctx) error {  return c.SendString(c.Params("test"))})// curl -X GET https://127.0.0.1:3000/12// 12// curl -X GET https://127.0.0.1:3000/1// Cannot GET /1
```

æ³¨æ„

åœ¨ä½¿ç”¨ datetime çº¦æŸï¼ˆ`*`ã€`+`ã€`?`ã€`:`ã€`/`ã€`<`ã€`>`ã€`;`ã€`(`ã€`)`ï¼‰æ—¶ï¼Œä½ åº”è¯¥åœ¨è·¯ç”±ç‰¹å®šå­—ç¬¦å‰ä½¿ç”¨ `\\`ï¼Œä»¥é¿å…é”™è¯¯è§£æã€‚

**å¯é€‰å‚æ•°ç¤ºä¾‹**

ä½ ä¹Ÿå¯ä»¥å¯¹å¯é€‰å‚æ•°æ–½åŠ çº¦æŸã€‚

```go
app.Get("/:test<int>?", func(c *fiber.Ctx) error {  return c.SendString(c.Params("test"))})// curl -X GET https://127.0.0.1:3000/42// 42// curl -X GET https://127.0.0.1:3000///// curl -X GET https://127.0.0.1:3000/7.0// Cannot GET /7.0
```

## ä¸­é—´ä»¶[](#middleware "ç›´æ¥é“¾æ¥åˆ°ä¸­é—´ä»¶")

ç”¨äºå¯¹è¯·æ±‚æˆ–å“åº”è¿›è¡Œæ›´æ”¹çš„å‡½æ•°ç§°ä¸º**ä¸­é—´ä»¶å‡½æ•°**ã€‚å½“è°ƒç”¨ [Next](https://docs.fiber.org.cn/api/ctx#next)ï¼ˆ**Fiber** è·¯ç”±å‡½æ•°ï¼‰æ—¶ï¼Œå®ƒå°†æ‰§è¡Œ**åŒ¹é…**å½“å‰è·¯ç”±çš„**ä¸‹ä¸€ä¸ª**å‡½æ•°ã€‚

**ä¸­é—´ä»¶å‡½æ•°ç¤ºä¾‹**

```go
app.Use(func(c *fiber.Ctx) error {  // Set a custom header on all responses:  c.Set("X-Custom-Header", "Hello, World")  // Go to next middleware:  return c.Next()})app.Get("/", func(c *fiber.Ctx) error {  return c.SendString("Hello, World!")})
```

`Use` æ–¹æ³•è·¯å¾„æ˜¯**æŒ‚è½½**æˆ–**å‰ç¼€**è·¯å¾„ï¼Œå¹¶é™åˆ¶ä¸­é—´ä»¶ä»…åº”ç”¨äºä»¥å…¶å¼€å¤´çš„ä»»ä½•è¯·æ±‚è·¯å¾„ã€‚

### åŠ¨æ€æ·»åŠ è·¯ç”±çš„çº¦æŸ[](#constraints-on-adding-routes-dynamically "ç›´æ¥é“¾æ¥åˆ°åŠ¨æ€æ·»åŠ è·¯ç”±çš„çº¦æŸ")

æ³¨æ„

ç”±äºè®¾è®¡å’Œæ€§èƒ½è€ƒè™‘ï¼Œä¸æ”¯æŒåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨ååŠ¨æ€æ·»åŠ è·¯ç”±ã€‚è¯·ç¡®ä¿åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨å‰å®šä¹‰æ‰€æœ‰è·¯ç”±ã€‚

## åˆ†ç»„[](#grouping "ç›´æ¥é“¾æ¥åˆ°åˆ†ç»„")

å¦‚æœæ‚¨æœ‰è®¸å¤šç«¯ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ `Group` æ¥ç»„ç»‡æ‚¨çš„è·¯ç”±ã€‚

```go
func main() {  app := fiber.New()  api := app.Group("/api", middleware) // /api  v1 := api.Group("/v1", middleware)   // /api/v1  v1.Get("/list", handler)             // /api/v1/list  v1.Get("/user", handler)             // /api/v1/user  v2 := api.Group("/v2", middleware)   // /api/v2  v2.Get("/list", handler)             // /api/v2/list  v2.Get("/user", handler)             // /api/v2/user  log.Fatal(app.Listen(":3000"))}
```

æœ‰å…³æ­¤å†…å®¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„ [åˆ†ç»„æŒ‡å—](https://docs.fiber.org.cn/guide/grouping)