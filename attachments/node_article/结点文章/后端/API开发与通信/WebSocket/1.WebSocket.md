# WebSocket

Baseline Widely available \*

This feature is well established and works across many devices and browser versions. It’s been available across browsers since July 2015.

\* Some parts of this feature may have varying levels of support.

+   [Learn more](/zh-CN/docs/Glossary/Baseline/Compatibility)
+   [See full compatibility](#浏览器兼容性)
+   [Report feedback](https://survey.alchemer.com/s3/7634825/MDN-baseline-feedback?page=%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWebSocket&level=high)

`WebSocket` 对象提供了用于创建和管理 [WebSocket](/zh-CN/docs/Web/API/WebSockets_API) 连接，以及可以通过该连接发送和接收数据的 API。

使用 [`WebSocket()`](/zh-CN/docs/Web/API/WebSocket/WebSocket) 构造函数来构造一个 `WebSocket`。

## 构造函数

[`WebSocket(url[, protocols])`](/zh-CN/docs/Web/API/WebSocket/WebSocket "WebSocket(url[, protocols])")

返回一个 `WebSocket` 对象。

## 常量

| **Constant**           | **Value** |
| ---------------------- | --------- |
| `WebSocket.CONNECTING` | `0`       |
| `WebSocket.OPEN`       | `1`       |
| `WebSocket.CLOSING`    | `2`       |
| `WebSocket.CLOSED`     | `3`       |

## 属性

[`WebSocket.binaryType`](/zh-CN/docs/Web/API/WebSocket/binaryType)

使用二进制的数据类型连接。

[`WebSocket.bufferedAmount`](/zh-CN/docs/Web/API/WebSocket/bufferedAmount) 只读

未发送至服务器的字节数。

[`WebSocket.extensions`](/zh-CN/docs/Web/API/WebSocket/extensions) 只读

服务器选择的扩展。

[`WebSocket.onclose`](/zh-CN/docs/Web/API/WebSocket/close_event)

用于指定连接关闭后的回调函数。

[`WebSocket.onerror`](/zh-CN/docs/Web/API/WebSocket/error_event)

用于指定连接失败后的回调函数。

[`WebSocket.onmessage`](/zh-CN/docs/Web/API/WebSocket/message_event)

用于指定当从服务器接受到信息时的回调函数。

[`WebSocket.onopen`](/zh-CN/docs/Web/API/WebSocket/open_event)

用于指定连接成功后的回调函数。

[`WebSocket.protocol`](/zh-CN/docs/Web/API/WebSocket/protocol) 只读

服务器选择的下属协议。

[`WebSocket.readyState`](/zh-CN/docs/Web/API/WebSocket/readyState) 只读

当前的链接状态。

[`WebSocket.url`](/zh-CN/docs/Web/API/WebSocket/url) 只读

WebSocket 的绝对路径。

## 方法

[`WebSocket.close([code[, reason]])`](/zh-CN/docs/Web/API/WebSocket/close "WebSocket.close([code[, reason]])")

关闭当前链接。

[`WebSocket.send(data)`](/zh-CN/docs/Web/API/WebSocket/send "WebSocket.send(data)")

对要传输的数据进行排队。

## 事件

使用 `addEventListener()` 或将一个事件监听器赋值给本接口的 `oneventname` 属性，来监听下面的事件。

[`close`](/zh-CN/docs/Web/API/WebSocket/close_event "close")

当一个 `WebSocket` 连接被关闭时触发。 也可以通过 [`onclose`](/zh-CN/docs/Web/API/WebSocket/close_event "onclose") 属性来设置。

[`error`](/zh-CN/docs/Web/API/WebSocket/error_event "error")

当一个 `WebSocket` 连接因错误而关闭时触发，例如无法发送数据时。 也可以通过 [`onerror`](/zh-CN/docs/Web/API/WebSocket/error_event "onerror") 属性来设置。

[`message`](/zh-CN/docs/Web/API/WebSocket/message_event "message")

当通过 `WebSocket` 收到数据时触发。 也可以通过 [`onmessage`](/zh-CN/docs/Web/API/WebSocket/message_event "onmessage") 属性来设置。

[`open`](/zh-CN/docs/Web/API/WebSocket/open_event "open")

当一个 `WebSocket` 连接成功时触发。 也可以通过 [`onopen`](/zh-CN/docs/Web/API/WebSocket/open_event "onopen") 属性来设置。

## 示例

js

```js
// Create WebSocket connection.
const socket = new WebSocket("ws://localhost:8080");

// Connection opened
socket.addEventListener("open", function (event) {
  socket.send("Hello Server!");
});

// Listen for messages
socket.addEventListener("message", function (event) {
  console.log("Message from server ", event.data);
});
```

## 规范

| Specification                                                |
| ------------------------------------------------------------ |
| [WebSockets                                                  |
| \# the-websocket-interface](https://websockets.spec.whatwg.org/#the-websocket-interface) |

## 浏览器兼容性

BCD tables only load in the browser

with JavaScript enabled. Enable JavaScript to view data.

## 参见

+   [Writing WebSocket client applications](/zh-CN/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications)